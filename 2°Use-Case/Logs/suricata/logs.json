{
    "comment": "1° Request"
}

{
    
    "timestamp": "2024-06-11T10:27:19.228719+0000",
    "flow_id": 2096784327363492,
    "in_iface": "webserver--1809",
    "event_type": "alert",
    "src_ip": "172.16.0.1",
    "src_port": 55212,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "alert": {
        "action": "allowed",
        "gid": 1,
        "signature_id": 1000001,
        "rev": 1,
        "signature": "Detected curl/8.5.0 user-agent",
        "category": "",
        "severity": 3
    },
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "application/octet-stream",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 403,
        "length": 37,
        "http_response_body_printable": "Forbidden - Malicious Header Detected",
        "http_response_body": "Rm9yYmlkZGVuIC0gTWFsaWNpb3VzIEhlYWRlciBEZXRlY3RlZA=="
    },
    "app_proto": "http",
    "direction": "to_server",
    "flow": {
        "pkts_toserver": 4,
        "pkts_toclient": 3,
        "bytes_toserver": 376,
        "bytes_toclient": 412,
        "start": "2024-06-11T10:27:19.226051+0000",
        "src_ip": "172.16.0.1",
        "dest_ip": "172.16.0.0",
        "src_port": 55212,
        "dest_port": 80
    },
    "payload": "R0VUIC8gSFRUUC8xLjENCkhvc3Q6IDE3Mi4xNi4wLjANClVzZXItQWdlbnQ6IGN1cmwvOC41LjANCkFjY2VwdDogKi8qDQpYLU1hbGljaW91cy1IZWFkZXI6IGJhZF92YWx1ZQ0KDQo=",
    "payload_printable": "GET / HTTP/1.1\r\nHost: 172.16.0.0\r\nUser-Agent: curl/8.5.0\r\nAccept: */*\r\nX-Malicious-Header: bad_value\r\n\r\n",
    "stream": 1,
    "packet": "Av72Sn95Av5CWUUSCABFAAA0IBtAAEAGwoesEAABrBAAANesAFBQewKIfEtcP4AQAel4egAAAQEICpnLpYB82uSG",
    "packet_info": {
        "linktype": 1
    }
}
{
    "timestamp": "2024-06-11T10:27:19.228719+0000",
    "flow_id": 2096784327363492,
    "in_iface": "webserver--1809",
    "event_type": "http",
    "src_ip": "172.16.0.1",
    "src_port": 55212,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "application/octet-stream",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 403,
        "length": 37,
        "request_headers": [
            {
                "name": "Host",
                "value": "172.16.0.0"
            },
            {
                "name": "User-Agent",
                "value": "curl/8.5.0"
            },
            {
                "name": "Accept",
                "value": "*/*"
            },
            {
                "name": "X-Malicious-Header",
                "value": "bad_value"
            }
        ],
        "response_headers": [
            {
                "name": "Server",
                "value": "nginx/1.27.0"
            },
            {
                "name": "Date",
                "value": "Tue, 11 Jun 2024 10:27:19 GMT"
            },
            {
                "name": "Content-Type",
                "value": "application/octet-stream"
            },
            {
                "name": "Content-Length",
                "value": "37"
            },
            {
                "name": "Connection",
                "value": "keep-alive"
            }
        ]
    }
}


///////////////////////////////////////////////////////////
{
    "comment": "2° Request",
}
///////////////////////////////////////////////////////////

{
    "timestamp": "2024-06-11T10:27:20.385623+0000",
    "flow_id": 239709169554813,
    "in_iface": "webserver--1809",
    "event_type": "alert",
    "src_ip": "172.16.0.1",
    "src_port": 55222,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "alert": {
        "action": "allowed",
        "gid": 1,
        "signature_id": 1000001,
        "rev": 1,
        "signature": "Detected curl/8.5.0 user-agent",
        "category": "",
        "severity": 3
    },
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "application/octet-stream",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 403,
        "length": 37,
        "http_response_body_printable": "Forbidden - Malicious Header Detected",
        "http_response_body": "Rm9yYmlkZGVuIC0gTWFsaWNpb3VzIEhlYWRlciBEZXRlY3RlZA=="
    },
    "app_proto": "http",
    "direction": "to_server",
    "flow": {
        "pkts_toserver": 4,
        "pkts_toclient": 3,
        "bytes_toserver": 376,
        "bytes_toclient": 412,
        "start": "2024-06-11T10:27:20.383491+0000",
        "src_ip": "172.16.0.1",
        "dest_ip": "172.16.0.0",
        "src_port": 55222,
        "dest_port": 80
    },
    "payload": "R0VUIC8gSFRUUC8xLjENCkhvc3Q6IDE3Mi4xNi4wLjANClVzZXItQWdlbnQ6IGN1cmwvOC41LjANCkFjY2VwdDogKi8qDQpYLU1hbGljaW91cy1IZWFkZXI6IGJhZF92YWx1ZQ0KDQo=",
    "payload_printable": "GET / HTTP/1.1\r\nHost: 172.16.0.0\r\nUser-Agent: curl/8.5.0\r\nAccept: */*\r\nX-Malicious-Header: bad_value\r\n\r\n",
    "stream": 1,
    "packet": "Av72Sn95Av5CWUUSCABFAAA0RphAAEAGnAqsEAABrBAAANe2AFDsVLuD6N8RaYAQAen40gAAAQEICpnLqgV82ukL",
    "packet_info": {
        "linktype": 1
    }
}
{
    "timestamp": "2024-06-11T10:27:20.385623+0000",
    "flow_id": 239709169554813,
    "in_iface": "webserver--1809",
    "event_type": "http",
    "src_ip": "172.16.0.1",
    "src_port": 55222,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "application/octet-stream",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 403,
        "length": 37,
        "request_headers": [
            {
                "name": "Host",
                "value": "172.16.0.0"
            },
            {
                "name": "User-Agent",
                "value": "curl/8.5.0"
            },
            {
                "name": "Accept",
                "value": "*/*"
            },
            {
                "name": "X-Malicious-Header",
                "value": "bad_value"
            }
        ],
        "response_headers": [
            {
                "name": "Server",
                "value": "nginx/1.27.0"
            },
            {
                "name": "Date",
                "value": "Tue, 11 Jun 2024 10:27:20 GMT"
            },
            {
                "name": "Content-Type",
                "value": "application/octet-stream"
            },
            {
                "name": "Content-Length",
                "value": "37"
            },
            {
                "name": "Connection",
                "value": "keep-alive"
            }
        ]
    }
}


///////////////////////////////////////////////////////////
{
    "comment": "3° Request",
}
///////////////////////////////////////////////////////////
{
    "timestamp": "2024-06-11T10:27:21.260319+0000",
    "flow_id": 545885919310526,
    "in_iface": "webserver--1809",
    "event_type": "alert",
    "src_ip": "172.16.0.1",
    "src_port": 41030,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "alert": {
        "action": "allowed",
        "gid": 1,
        "signature_id": 1000001,
        "rev": 1,
        "signature": "Detected curl/8.5.0 user-agent",
        "category": "",
        "severity": 3
    },
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "application/octet-stream",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 403,
        "length": 37,
        "http_response_body_printable": "Forbidden - Malicious Header Detected",
        "http_response_body": "Rm9yYmlkZGVuIC0gTWFsaWNpb3VzIEhlYWRlciBEZXRlY3RlZA=="
    },
    "app_proto": "http",
    "direction": "to_server",
    "flow": {
        "pkts_toserver": 4,
        "pkts_toclient": 3,
        "bytes_toserver": 376,
        "bytes_toclient": 412,
        "start": "2024-06-11T10:27:21.258170+0000",
        "src_ip": "172.16.0.1",
        "dest_ip": "172.16.0.0",
        "src_port": 41030,
        "dest_port": 80
    },
    "payload": "R0VUIC8gSFRUUC8xLjENCkhvc3Q6IDE3Mi4xNi4wLjANClVzZXItQWdlbnQ6IGN1cmwvOC41LjANCkFjY2VwdDogKi8qDQpYLU1hbGljaW91cy1IZWFkZXI6IGJhZF92YWx1ZQ0KDQo=",
    "payload_printable": "GET / HTTP/1.1\r\nHost: 172.16.0.0\r\nUser-Agent: curl/8.5.0\r\nAccept: */*\r\nX-Malicious-Header: bad_value\r\n\r\n",
    "stream": 1,
    "packet": "Av72Sn95Av5CWUUSCABFAAA01l9AAEAGDEOsEAABrBAAAKBGAFAPKyLiRl7kd4AQAelurAAAAQEICpnLrW982ux2",
    "packet_info": {
        "linktype": 1
    }
}
{
    "timestamp": "2024-06-11T10:27:21.260319+0000",
    "flow_id": 545885919310526,
    "in_iface": "webserver--1809",
    "event_type": "http",
    "src_ip": "172.16.0.1",
    "src_port": 41030,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "application/octet-stream",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 403,
        "length": 37,
        "request_headers": [
            {
                "name": "Host",
                "value": "172.16.0.0"
            },
            {
                "name": "User-Agent",
                "value": "curl/8.5.0"
            },
            {
                "name": "Accept",
                "value": "*/*"
            },
            {
                "name": "X-Malicious-Header",
                "value": "bad_value"
            }
        ],
        "response_headers": [
            {
                "name": "Server",
                "value": "nginx/1.27.0"
            },
            {
                "name": "Date",
                "value": "Tue, 11 Jun 2024 10:27:21 GMT"
            },
            {
                "name": "Content-Type",
                "value": "application/octet-stream"
            },
            {
                "name": "Content-Length",
                "value": "37"
            },
            {
                "name": "Connection",
                "value": "keep-alive"
            }
        ]
    }
}


///////////////////////////////////////////////////////////
{
    "comment": "Suricata logs after realignment workflow.",
}
///////////////////////////////////////////////////////////
{
    "timestamp": "2024-06-11T10:55:15.079755+0000",
    "flow_id": 899984833641278,
    "in_iface": "webserver--0f49",
    "event_type": "alert",
    "src_ip": "172.16.0.1",
    "src_port": 33792,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "alert": {
        "action": "allowed",
        "gid": 1,
        "signature_id": 1000001,
        "rev": 1,
        "signature": "Detected curl/8.5.0 user-agent",
        "category": "",
        "severity": 3
    },
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "text/html",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 400,
        "length": 3519,
        "http_response_body_printable": "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\"><html><head><meta type=\"copyright\" content=\"Copyright (C) 1996-2021 The Squid Software Foundation and contributors\"><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"><title>ERROR: The requested URL could not be retrieved</title><style type=\"text/css\"><!-- /* Copyright (C) 1996-2023 The Squid Software Foundation and contributors * Squid software is distributed under GPLv2+ license and includes contributions from numerous individuals and organizations. Please see the COPYING and CONTRIBUTORS files for details. */ /* Stylesheet for Squid Error pages Adapted from design by Free CSS Templates http://www.freecsstemplates.org Released for free under a Creative Commons Attribution 2.5 License */ /* Page basics */ * { font-family: verdana, sans-serif; } html body { margin: 0; padding: 0; background: #efefef; font-size: 12px; color: #1e1e1e; } /* Page displayed title area */ #titles { margin-left: 15px; padding: 10px; padding-left: 100px; background: url('/squid-internal-static/icons/SN.png') no-repeat left; } /* initial title */ #titles h1 { color: #000000; } #titles h2 { color: #000000; } /* special event: FTP success page titles */ #titles ftpsuccess { background-color:#00ff00; width:100%; } /* Page displayed body content area */ #content { padding: 10px; background: #ffffff; } /* General text */ p { } /* error brief description */ #error p { } /* some data which may have caused the problem */ #data { } /* the error message received from the system or other software */ #sysmsg { } pre { } /* special event: FTP directory listing */ #dirmsg { font-family: courier, monospace; color: black; font-size: 10pt; } #dirlisting { margin-left: 2%; margin-right: 2%; } #dirlisting tr.entry td.icon,td.filename,td.size,td.date { border-bottom: groove; } #dirlisting td.size { width: 50px; text-align: right; padding-right: 5px; } /* horizontal lines */ hr { margin: 0; } /* page displayed footer area */ #footer { font-size: 9px; padding-left: 10px; } body :lang(fa) { direction: rtl; font-size: 100%; font-family: Tahoma, Roya, sans-serif; float: right; } :lang(he) { direction: rtl; } --></style></head><body id=ERR_ACCESS_DENIED><div id=\"titles\"><h1>ERROR</h1><h2>The requested URL could not be retrieved</h2></div><hr></body></html>",
        "http_response_body": "PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMDEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDQvc3RyaWN0LmR0ZCI+PGh0bWw+PGhlYWQ+PG1ldGEgdHlwZT0iY29weXJpZ2h0IiBjb250ZW50PSJDb3B5cmlnaHQgKEMpIDE5OTYtMjAyMSBUaGUgU3F1aWQgU29mdHdhcmUgRm91bmRhdGlvbiBhbmQgY29udHJpYnV0b3JzIj48bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCI+PHRpdGxlPkVSUk9SOiBUaGUgcmVxdWVzdGVkIFVSTCBjb3VsZCBub3QgYmUgcmV0cmlldmVkPC90aXRsZT48c3R5bGUgdHlwZT0idGV4dC9jc3MiPjwhLS0gLyogQ29weXJpZ2h0IChDKSAxOTk2LTIwMjMgVGhlIFNxdWlkIFNvZnR3YXJlIEZvdW5kYXRpb24gYW5kIGNvbnRyaWJ1dG9ycyAqIFNxdWlkIHNvZnR3YXJlIGlzIGRpc3RyaWJ1dGVkIHVuZGVyIEdQTHYyKyBsaWNlbnNlIGFuZCBpbmNsdWRlcyBjb250cmlidXRpb25zIGZyb20gbnVtZXJvdXMgaW5kaXZpZHVhbHMgYW5kIG9yZ2FuaXphdGlvbnMuIFBsZWFzZSBzZWUgdGhlIENPUFlJTkcgYW5kIENPTlRSSUJVVE9SUyBmaWxlcyBmb3IgZGV0YWlscy4gKi8gLyogU3R5bGVzaGVldCBmb3IgU3F1aWQgRXJyb3IgcGFnZXMgQWRhcHRlZCBmcm9tIGRlc2lnbiBieSBGcmVlIENTUyBUZW1wbGF0ZXMgaHR0cDovL3d3dy5mcmVlY3NzdGVtcGxhdGVzLm9yZyBSZWxlYXNlZCBmb3IgZnJlZSB1bmRlciBhIENyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24gMi41IExpY2Vuc2UgKi8gLyogUGFnZSBiYXNpY3MgKi8gKiB7IGZvbnQtZmFtaWx5OiB2ZXJkYW5hLCBzYW5zLXNlcmlmOyB9IGh0bWwgYm9keSB7IG1hcmdpbjogMDsgcGFkZGluZzogMDsgYmFja2dyb3VuZDogI2VmZWZlZjsgZm9udC1zaXplOiAxMnB4OyBjb2xvcjogIzFlMWUxZTsgfSAvKiBQYWdlIGRpc3BsYXllZCB0aXRsZSBhcmVhICovICN0aXRsZXMgeyBtYXJnaW4tbGVmdDogMTVweDsgcGFkZGluZzogMTBweDsgcGFkZGluZy1sZWZ0OiAxMDBweDsgYmFja2dyb3VuZDogdXJsKCcvc3F1aWQtaW50ZXJuYWwtc3RhdGljL2ljb25zL1NOLnBuZycpIG5vLXJlcGVhdCBsZWZ0OyB9IC8qIGluaXRpYWwgdGl0bGUgKi8gI3RpdGxlcyBoMSB7IGNvbG9yOiAjMDAwMDAwOyB9ICN0aXRsZXMgaDIgeyBjb2xvcjogIzAwMDAwMDsgfSAvKiBzcGVjaWFsIGV2ZW50OiBGVFAgc3VjY2VzcyBwYWdlIHRpdGxlcyAqLyAjdGl0bGVzIGZ0cHN1Y2Nlc3MgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMGZmMDA7IHdpZHRoOjEwMCU7IH0gLyogUGFnZSBkaXNwbGF5ZWQgYm9keSBjb250ZW50IGFyZWEgKi8gI2NvbnRlbnQgeyBwYWRkaW5nOiAxMHB4OyBiYWNrZ3JvdW5kOiAjZmZmZmZmOyB9IC8qIEdlbmVyYWwgdGV4dCAqLyBwIHsgfSAvKiBlcnJvciBicmllZiBkZXNjcmlwdGlvbiAqLyAjZXJyb3IgcCB7IH0gLyogc29tZSBkYXRhIHdoaWNoIG1heSBoYXZlIGNhdXNlZCB0aGUgcHJvYmxlbSAqLyAjZGF0YSB7IH0gLyogdGhlIGVycm9yIG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGUgc3lzdGVtIG9yIG90aGVyIHNvZnR3YXJlICovICNzeXNtc2cgeyB9IHByZSB7IH0gLyogc3BlY2lhbCBldmVudDogRlRQIGRpcmVjdG9yeSBsaXN0aW5nICovICNkaXJtc2cgeyBmb250LWZhbWlseTogY291cmllciwgbW9ub3NwYWNlOyBjb2xvcjogYmxhY2s7IGZvbnQtc2l6ZTogMTBwdDsgfSAjZGlybGlzdGluZyB7IG1hcmdpbi1sZWZ0OiAyJTsgbWFyZ2luLXJpZ2h0OiAyJTsgfSAjZGlybGlzdGluZyB0ci5lbnRyeSB0ZC5pY29uLHRkLmZpbGVuYW1lLHRkLnNpemUsdGQuZGF0ZSB7IGJvcmRlci1ib3R0b206IGdyb292ZTsgfSAjZGlybGlzdGluZyB0ZC5zaXplIHsgd2lkdGg6IDUwcHg7IHRleHQtYWxpZ246IHJpZ2h0OyBwYWRkaW5nLXJpZ2h0OiA1cHg7IH0gLyogaG9yaXpvbnRhbCBsaW5lcyAqLyBociB7IG1hcmdpbjogMDsgfSAvKiBwYWdlIGRpc3BsYXllZCBmb290ZXIgYXJlYSAqLyAjZm9vdGVyIHsgZm9udC1zaXplOiA5cHg7IHBhZGRpbmctbGVmdDogMTBweDsgfSBib2R5IDpsYW5nKGZhKSB7IGRpcmVjdGlvbjogcnRsOyBmb250LXNpemU6IDEwMCU7IGZvbnQtZmFtaWx5OiBUYWhvbWEsIFJveWEsIHNhbnMtc2VyaWY7IGZsb2F0OiByaWdodDsgfSA6bGFuZyhoZSkgeyBkaXJlY3Rpb246IHJ0bDsgfSAtLT48L3N0eWxlPjwvaGVhZD48Ym9keSBpZD1FUlJfQUNDRVNTX0RFTklFRD48ZGl2IGlkPSJ0aXRsZXMiPjxoMT5FUlJPUjwvaDE+PGgyPlRoZSByZXF1ZXN0ZWQgVVJMIGNvdWxkIG5vdCBiZSByZXRyaWV2ZWQ8L2gyPjwvZGl2Pjxocj48L2JvZHk+PC9odG1sPg=="
    }
},
{
    "timestamp": "2024-06-11T10:55:15.079755+0000",
    "flow_id": 899984833641278,
    "in_iface": "webserver--0f49",
    "event_type": "http",
    "src_ip": "172.16.0.1",
    "src_port": 33792,
    "dest_ip": "172.16.0.0",
    "dest_port": 80,
    "proto": "TCP",
    "pkt_src": "wire/pcap",
    "tx_id": 0,
    "http": {
        "hostname": "172.16.0.0",
        "url": "/",
        "http_user_agent": "curl/8.5.0",
        "http_content_type": "text/html",
        "http_method": "GET",
        "protocol": "HTTP/1.1",
        "status": 400,
        "length": 3519,
        "request_headers": [
            {
                "name": "Host",
                "value": "172.16.0.0"
            },
            {
                "name": "User-Agent",
                "value": "curl/8.5.0"
            },
            {
                "name": "Accept",
                "value": "*/*"
            }
        ],
        "response_headers": [
            {
                "name": "Server",
                "value": "squid/6.1"
            },
            {
                "name": "Mime-Version",
                "value": "1.0"
            },
            {
                "name": "Date",
                "value": "Tue, 11 Jun 2024 10:55:15 GMT"
            },
            {
                "name": "Content-Type",
                "value": "text/html;charset=utf-8"
            },
            {
                "name": "Content-Length",
                "value": "3519"
            },
            {
                "name": "X-Squid-Error",
                "value": "ERR_ACCESS_DENIED"
            },
            {
                "name": "Vary",
                "value": "Accept-Language"
            },
            {
                "name": "Content-Language",
                "value": "en"
            },
            {
                "name": "Cache-Status",
                "value": "squid-856449554f-5twvf"
            },
            {
                "name": "Via",
                "value": "1.1 squid-856449554f-5twvf (squid/6.1)"
            },
            {
                "name": "Connection",
                "value": "close"
            }
        ]
    }
}